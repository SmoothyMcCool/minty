<div class="container-fluid">
	<div class="row">
		<div class="col-4 col-sm-6">
			<h4>Active Conversations</h4>
			<form>
				<div class="form-check">
					<input class="form-check-input" type="radio" name="orderAlphabetical" id="orderAlphabetical"
						[(ngModel)]="conversationSortOrder" value="alpha" (change)="sortConversationsBy('alpha')" checked>
					<label class="form-check-label" for="orderAlphabetical">
						Order A-Z
					</label>
				</div>
				<div class="form-check">
					<input class="form-check-input" type="radio" name="orderLastUsed" id="orderLastUsed"
						[(ngModel)]="conversationSortOrder" value="lastUsed" (change)="sortConversationsBy('lastUsed')">
					<label class="form-check-label" for="orderLastUsed">
						Order by Last Used
					</label>
				</div>
			</form>
			<ul class="list-group">
				<li class="list-group-item list-group-item-action position-relative text-bg-light bg-opacity-75"
					*ngFor="let conversation of conversations" style="height: 2.5rem">
					<div class="d-flex align-items-center h-100">
						<span class="text-truncate clickable-text" (click)="selectConversation(conversation)">
							{{getConversationTitle(conversation)}}
						</span>
						<span class="badge text-bg-secondary mx-2">{{getConversationAssistantName(conversation)}}</span>
						<span class="flex-grow-1"></span>
						<button class="btn btn-sm" style="font-size: 14px;" (click)="renameConversation(conversation)">
							<i class="bi bi-pencil-square"></i>
						</button>
						<button type="button" class="btn btn-sm p-0" style="font-size: 14px; color: red"
							[disabled]="deleteInProgress" (click)="deleteConversation(conversation)">
							<i class="bi bi-trash3"></i>
						</button>
					</div>
				</li>
			</ul>
		</div>
		<div class="col-8 col-sm-6">

			<div class="row">
				<form>
					<div class="form-group well mb-2 p-2">
						<label class="" for="assistantFilter">Filter</label>
						<input type="text" class="form-control" id="assistantFilter" name="assistantFilter"
							[(ngModel)]="assistantFilter">
					</div>
				</form>
				<h4>My Assistants</h4>
				<ng-container *ngIf="assistants.length > 0; else noAssistants">
					<div class="col-12" *ngFor="let assistant of assistantPassesFilter(false)">
						<div class="card text-bg-light bg-opacity-75">
							<div class="position-absolute top-0 end-0" *ngIf="isOwned(assistant)">
								<button class="btn btn-sm" style="font-size: 14px;"
									(click)="editAssistant(assistant.id)">
									<i class="bi bi-pencil-square"></i>
								</button>
								<button class="btn btn-sm" style="font-size: 14px; color: red;"
									[disabled]="deleteInProgress" (click)="deleteAssistant(assistant)">
									<i class="bi bi-trash3"></i>
								</button>
							</div>
							<div class="card-body">
								<div class="row align-items-center g-2">
									<button class="btn btn-primary col-auto"
										(click)="startConversation(assistant)">Let's Rap!</button>
									<div class="col-auto">
										<h5 class="card-title mb-0">{{assistant.name}}</h5>
									</div>
									<div class="col-auto">
										<span class="badge text-bg-secondary mx-2">{{assistant.model}}</span>
									</div>
								</div>
							</div>
						</div>
					</div>
				</ng-container>
				<ng-template #noAssistants>
					<p class="font-monospace ms-4">If you had any assistants they would be listed here.</p>
				</ng-template>
			</div>
			<div class="row">
				<h4>Shared Assistants</h4>
				<ng-container *ngIf="sharedAssistants.length > 0; else noSharedAssistants">
					<div class="col-12" *ngFor="let assistant of assistantPassesFilter(true)">
						<div class="card text-bg-light bg-opacity-75">
							<div class="position-absolute top-0 end-0" *ngIf="isOwned(assistant)">
								<button class="btn btn-sm" style="font-size: 14px;"
									(click)="editAssistant(assistant.id)">
									<i class="bi bi-pencil-square"></i>
								</button>
								<button class="btn btn-sm" style="font-size: 14px; color: red;"
									[disabled]="deleteInProgress" (click)="deleteAssistant(assistant)">
									<i class="bi bi-trash3"></i>
								</button>
							</div>
							<div class="card-body">
								<div class="row align-items-center g-2">
									<button class="btn btn-primary col-auto"
										(click)="startConversation(assistant)">Let's Rap!</button>
									<div class="col-auto">
										<h5 class="card-title mb-0">{{assistant.name}}</h5>
									</div>
									<div class="col-auto">
										<span class="badge text-bg-secondary mx-2">{{assistant.model}}</span>
									</div>
								</div>
							</div>
						</div>
					</div>
				</ng-container>
				<ng-template #noSharedAssistants>
					<p class="font-monospace ms-4">If any assistants had been shared with you they'd be listed
						here.<br>
						I guess you have no friends ðŸ˜¢
					</p>
				</ng-template>
			</div>
		</div>
	</div>
</div>

<minty-confirmation-dialog [title]="'Delete Assistant'" [message]="'Are you sure you want to delete this Assistant?'"
	[visible]="confirmDeleteAssistantVisible" (confirm)="confirmDeleteAssistant()"
	(cancel)="confirmDeleteAssistantVisible = false">
</minty-confirmation-dialog>

<minty-confirmation-dialog [title]="'Delete Conversation'"
	[message]="'Are you sure you want to delete this Conversation?'" [visible]="confirmDeleteConversationVisible"
	(confirm)="confirmDeleteConversation()" (cancel)="confirmDeleteConversationVisible = false">
</minty-confirmation-dialog>

<div class="modal show d-block" tabindex="-1" *ngIf="renameConversationVisible">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<h5 class="modal-title">What's the new Title?</h5>
				<button type="button" class="btn-close" (click)="onCancel()" aria-label="Close"></button>
			</div>
			<div class="modal-body">
				<input class="form-control" type="text" name="conversationName" maxlength="50"
					[(ngModel)]="renamedConversationTitle">
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-secondary" (click)="onCancelConversationRename()">Cancel</button>
				<button type="button" class="btn btn-primary" (click)="onConfirmConversationRename()">Confirm</button>
			</div>
		</div>
	</div>
</div>